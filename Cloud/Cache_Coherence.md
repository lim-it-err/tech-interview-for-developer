# Cache Coherence
## 정의
- 여러 캐시 안에 있는 데이터들이(데이터 복사본들이)
- 일관성을 유지하는 것.

## 해결 방법
### MESI Protocol
- 수정됨(Modified, M): 해당 캐시 라인이 변경되었으며, 이 캐시가 해당 데이터의 유일한 최신 복사본을 가지고 있음을 의미합니다. 이 상태의 데이터는 아직 메인 메모리에 쓰여지지 않았습니다.
- 독점적(Exclusive, E): 해당 캐시 라인이 변경되지 않았으나, 이 캐시가 해당 데이터의 유일한 복사본을 가지고 있음을 의미합니다. 이 데이터는 메인 메모리와 동일한 값을 가지고 있으며, 다른 캐시에는 없습니다.
- 공유됨(Shared, S): 해당 캐시 라인이 변경되지 않았으며, 이 데이터의 복사본이 다른 캐시에도 존재할 수 있음을 의미합니다. 이 상태는 데이터가 여러 캐시에 읽기 전용으로 공유될 수 있음을 나타냅니다.
- 무효화됨(Invalidate, I): 해당 캐시 라인이 유효하지 않거나 사용할 수 없음을 의미합니다. 데이터가 변경되었을 때, 다른 캐시의 같은 데이터 복사본은 이 상태로 무효화됩니다.

로컬 프로세서와 버스의 Action이 다르다.
### MOESI 프로토콜
MESI에 "소유함(Owned, O)" 상태를 추가한 프로토콜입니다. 이 상태는 데이터가 수정되었으며 다른 캐시와 공유될 수 있음을 나타냅니다. 소유한 캐시는 다른 캐시의 요청에 응답하여 데이터를 제공할 수 있으며, 메인 메모리의 데이터를 최신 상태로 유지합니다.

### Directory-based Coherence
이 방법은 공유 데이터의 메모리 위치에 "디렉토리"를 유지하여, 특정 데이터를 가진 캐시의 정보를 추적합니다. 데이터가 요청될 때, 디렉토리는 해당 데이터의 복사본을 가진 모든 캐시를 확인하고, 필요한 조치를 취하여 일관성을 유지합니다. 이 방식은 스케일이 큰 시스템에 적합합니다.

### Snooping
이 기법은 모든 캐시가 버스를 통해 다른 캐시의 트랜잭션을 "엿보고(snoop)" 일관성을 유지합니다. 캐시는 자신이 보유한 데이터에 대한 다른 캐시의 요청을 감지하고, 필요한 경우 데이터의 상태를 업데이트합니다. MESI 프로토콜이 이 기법을 사용합니다.

### Write-once
이 기법은 캐시 코히어런스의 초기 접근 방식 중 하나로, 데이터가 처음 쓰여질 때 모든 캐시에 복제됩니다. 이후 수정은 해당 캐시에서만 일어나며, 다른 캐시는 더 이상 이 데이터를 사용할 수 없습니다.




## 비고
### Consistency
Memory Coherence는 데이터 일관성에 대해 논하고, Consistency는 연산 순서에 대해 논함.
consistency: 메모리 접근 연산이 다른 메모리 접근 연산에 대하여 일관되는 규칙대로 수행되는 것